# 🎯 牌型识别功能测试

## 📋 概述

基于 `docs/1.md` 文档指导创建的独立牌型识别测试场景，用于验证和测试完整的牌型识别系统。

## 🏗️ 系统架构

### 核心组件
- **HandTypeTestCore** - 牌型识别测试核心模块
- **SmartHandAnalyzer** - 智能多张牌最佳组合分析器  
- **PokerHandAnalyzer** - 基础5张牌牌型识别器
- **HandRankingSystem** - 牌型等级和倍率系统
- **HandTypeResultDisplay** - 牌型结果显示组件

### 分层设计
```
测试核心层 (HandTypeTestCore)
    ↓
智能分析层 (SmartHandAnalyzer)
    ↓
基础识别层 (PokerHandAnalyzer)
    ↓
等级系统层 (HandRankingSystem)
    ↓
显示组件层 (HandTypeResultDisplay)
```

## 🎮 使用方法

### 快捷键操作
- **R** - 开始回合
- **N** - 下回合（重置操作次数）
- **1** - 识别牌型（最多3次/回合）
- **2** - 弃牌（最多2次/回合）
- **T** - 运行完整测试套件
- **点击牌库图标** - 查看完整牌库

### 测试功能
- **自动发牌**：系统自动发放5张初始手牌
- **手动选择卡牌**：点击选择1-5张卡牌
- **牌型识别**：按"1"键或点击出牌按钮进行识别
- **结果显示**：
  - 识别的牌型名称和等级
  - 最佳牌型组合的卡牌
  - 弃置的卡牌（如有）
  - 详细得分计算公式
  - 性能指标（分析耗时、组合数量等）
- **实时UI显示**：使用专用结果面板显示分析结果

## 🧪 测试套件

### 基础牌型测试
- [ ] 高牌：5张不同花色、不连续的牌
- [ ] 一对：2张相同数值 + 3张杂牌
- [ ] 两对：2对相同数值 + 1张杂牌
- [ ] 三条：3张相同数值 + 2张杂牌

### 高级牌型测试
- [ ] 顺子：5张连续数值（不同花色）
- [ ] 同花：5张相同花色（不连续）
- [ ] 葫芦：3张相同数值 + 1对
- [ ] 四条：4张相同数值 + 1张杂牌

### 特殊牌型测试
- [ ] 同花顺：5张连续且同花色
- [ ] 皇家同花顺：A-10-J-Q-K同花色
- [ ] A顺子：A-2-3-4-5 和 10-J-Q-K-A
- [ ] 五条：5张相同数值（需要复制效果）

### 多张牌组合测试
- [ ] 6张牌：验证能找出最佳5张组合
- [ ] 7张牌：验证组合算法效率
- [ ] 8张牌：验证复杂组合识别

## 📊 动态等级系统

### 牌型等级（LV1-LV5）
| 等级 | 牌型 | 英文名 | 基础分值 | LV1倍率 | 每级增量 | LV5倍率 |
|------|------|--------|----------|---------|----------|---------|
| 1 | 高牌 | HIGH_CARD | 1 | 1.0x | +0.2x | 1.8x |
| 2 | 一对 | PAIR | 2 | 1.5x | +0.3x | 2.7x |
| 3 | 两对 | TWO_PAIR | 3 | 2.0x | +0.4x | 3.6x |
| 4 | 三条 | THREE_KIND | 5 | 3.0x | +0.6x | 5.4x |
| 5 | 顺子 | STRAIGHT | 8 | 4.0x | +0.8x | 7.2x |
| 6 | 同花 | FLUSH | 13 | 5.0x | +1.0x | 9.0x |
| 7 | 葫芦 | FULL_HOUSE | 21 | 7.0x | +1.4x | 12.6x |
| 8 | 四条 | FOUR_KIND | 34 | 10.0x | +2.0x | 18.0x |
| 9 | 同花顺 | STRAIGHT_FLUSH | 55 | 15.0x | +3.0x | 27.0x |
| 10 | 皇家同花顺 | ROYAL_FLUSH | 89 | 25.0x | +5.0x | 45.0x |
| 11 | 五条 | FIVE_KIND | 144 | 50.0x | +10.0x | 90.0x |

## 🔧 实现状态

### ✅ 已完成
- [x] 基础测试场景框架
- [x] UI界面设计
- [x] 基础管理器集成
- [x] 快捷键系统

### 🚧 待实现
- [ ] HandTypeTestCore 核心模块
- [ ] SmartHandAnalyzer 智能分析器
- [ ] PokerHandAnalyzer 基础识别器
- [ ] HandRankingSystem 等级系统
- [ ] HandTypeResultDisplay 结果显示组件
- [ ] 完整测试套件
- [ ] 性能测试功能
- [ ] 批量测试功能

## 📁 文件结构

```
cs/tests/卡牌相关/牌型识别测试/
├── HandTypeTest.gd                 # 主测试脚本
├── HandTypeTestScene.tscn          # 测试场景文件
├── README.md                       # 说明文档
├── HandTypeTestCore.gd             # 核心测试模块（待创建）
├── SmartHandAnalyzer.gd            # 智能分析器（待创建）
├── PokerHandAnalyzer.gd            # 基础识别器（待创建）
├── HandRankingSystem.gd            # 等级系统（待创建）
└── HandTypeResultDisplay.gd        # 结果显示组件（待创建）
```

## 🎯 独立性保证

- **独立UID**：所有场景和脚本使用新生成的唯一UID
- **独立命名**：所有类名、节点名都使用 HandType 前缀
- **独立路径**：完全独立的目录结构
- **无冲突**：不影响现有的出牌系统测试功能
