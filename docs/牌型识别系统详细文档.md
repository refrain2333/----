# ğŸ¯ å¥¥æœ¯å­¦é™¢æ‰‘å…‹ - ç‰Œå‹è¯†åˆ«ç³»ç»Ÿè¯¦ç»†æ–‡æ¡£

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

ç‰Œå‹è¯†åˆ«ç³»ç»Ÿæ˜¯å¥¥æœ¯å­¦é™¢æ‰‘å…‹æ¸¸æˆçš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£è¯†åˆ«ç©å®¶å‡ºç‰Œçš„ç‰Œå‹ã€è®¡ç®—å¾—åˆ†ã€ç®¡ç†åŠ¨æ€ç­‰çº§ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒ1-13å¼ ä»»æ„æ•°é‡å¡ç‰Œçš„æ™ºèƒ½åˆ†æï¼Œèƒ½å¤Ÿä»å¤šå¼ å¡ç‰Œä¸­æ‰¾å‡ºæœ€ä½³5å¼ ç»„åˆã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **æ™ºèƒ½ç‰Œå‹è¯†åˆ«**ï¼šæ”¯æŒæ ‡å‡†æ‰‘å…‹ç‰Œå‹ï¼ˆé«˜ç‰Œåˆ°çš‡å®¶åŒèŠ±é¡ºï¼‰+ ç‰¹æ®Šç‰Œå‹ï¼ˆäº”æ¡ï¼‰
- **å¤šå¼ ç‰Œç»„åˆåˆ†æ**ï¼šä»Nå¼ å¡ç‰Œä¸­æ™ºèƒ½é€‰æ‹©æœ€ä½³5å¼ ç»„åˆ
- **åŠ¨æ€ç­‰çº§ç³»ç»Ÿ**ï¼šLV1-LV5ç­‰çº§ç®¡ç†ï¼Œæ”¯æŒç‰Œå‹å‡çº§å’Œå€ç‡è°ƒæ•´
- **å¤æ‚å¾—åˆ†è®¡ç®—**ï¼šå›ºå®šåŸºç¡€åˆ† + åŠ¨æ€ç­‰çº§åˆ† + é™„åŠ åˆ† Ã— åŠ¨æ€å€ç‡
- **é«˜æ€§èƒ½ç®—æ³•**ï¼šé’ˆå¯¹ä¸åŒå¡ç‰Œæ•°é‡é‡‡ç”¨ä¸åŒä¼˜åŒ–ç­–ç•¥
- **å®Œæ•´æµ‹è¯•è¦†ç›–**ï¼šåŒ…å«è‡ªåŠ¨åŒ–æµ‹è¯•å¥—ä»¶å’ŒéªŒè¯æ¸…å•

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶å±‚æ¬¡ç»“æ„

```
ç‰Œå‹è¯†åˆ«ç³»ç»Ÿ
â”œâ”€â”€ æ•°æ®å±‚ (cs/å¡ç‰Œç³»ç»Ÿ/æ•°æ®/)
â”‚   â”œâ”€â”€ HandTypeEnums.gd          # ç‰Œå‹æšä¸¾å’Œå¸¸é‡å®šä¹‰
â”‚   â””â”€â”€ ç®¡ç†å™¨/
â”‚       â”œâ”€â”€ HandTypeAnalyzer.gd        # åŸºç¡€5å¼ ç‰Œè¯†åˆ«å™¨
â”‚       â”œâ”€â”€ SmartHandAnalyzer.gd       # æ™ºèƒ½å¤šå¼ ç‰Œåˆ†æå™¨
â”‚       â”œâ”€â”€ HandTypeScoreManager.gd    # å¾—åˆ†è®¡ç®—ç®¡ç†å™¨
â”‚       â””â”€â”€ HandTypeRankingManager.gd  # åŠ¨æ€ç­‰çº§ç®¡ç†å™¨
â”œâ”€â”€ æµ‹è¯•å±‚ (cs/tests/å¡ç‰Œç›¸å…³/ç‰Œå‹è¯†åˆ«æµ‹è¯•/)
â”‚   â”œâ”€â”€ HandTypeTestCore.gd       # æµ‹è¯•æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ HandTypeTest.gd          # å®Œæ•´æµ‹è¯•åœºæ™¯
â”‚   â””â”€â”€ åŠŸèƒ½éªŒè¯æ¸…å•.md           # æµ‹è¯•éªŒè¯æ¸…å•
â””â”€â”€ é…ç½®å±‚
    â”œâ”€â”€ GameConfig.gd            # å…¨å±€æ¸¸æˆé…ç½®
    â””â”€â”€ game_config.tres         # é…ç½®èµ„æºæ–‡ä»¶
```

### ç»„ä»¶èŒè´£åˆ†å·¥

| ç»„ä»¶ | èŒè´£ | è¾“å…¥ | è¾“å‡º |
|------|------|------|------|
| **HandTypeEnums** | æšä¸¾å®šä¹‰ã€å¸¸é‡ç®¡ç† | - | ç‰Œå‹æšä¸¾ã€åŸºç¡€åˆ†å€¼ã€å€ç‡é…ç½® |
| **HandTypeAnalyzer** | æ ‡å‡†5å¼ ç‰Œè¯†åˆ« | 5å¼ CardData | ç‰Œå‹åˆ†æç»“æœ |
| **SmartHandAnalyzer** | æ™ºèƒ½å¤šå¼ ç‰Œåˆ†æ | 1-13å¼ CardData | æœ€ä½³ç»„åˆåˆ†æç»“æœ |
| **HandTypeScoreManager** | å¾—åˆ†è®¡ç®— | å¡ç‰Œæ•°ç»„ + ç­‰çº§ç®¡ç†å™¨ | è¯¦ç»†å¾—åˆ†ç»“æœ |
| **HandTypeRankingManager** | ç­‰çº§ç®¡ç† | ç‰Œå‹ã€ç­‰çº§æ“ä½œ | ç­‰çº§çŠ¶æ€ã€å€ç‡ |

---

## ğŸƒ æ”¯æŒçš„ç‰Œå‹

### æ ‡å‡†ç‰Œå‹ï¼ˆæŒ‰å¼ºåº¦æ’åºï¼‰

| ç‰Œå‹ | è‹±æ–‡å | æšä¸¾å€¼ | åŸºç¡€åˆ†å€¼ | ç¤ºä¾‹ | æè¿° |
|------|--------|--------|----------|------|------|
| é«˜ç‰Œ | HIGH_CARD | 1 | 5 | â™ K â™¥9 â™¦7 â™£5 â™ 2 | äº”å¼ ä¸åŒèŠ±è‰²ã€ä¸è¿ç»­çš„ç‰Œ |
| ä¸€å¯¹ | PAIR | 2 | 10 | â™ 7 â™¥7 â™¦9 â™£2 â™ 5 | ä¸¤å¼ ç›¸åŒæ•°å€¼ + ä¸‰å¼ æ‚ç‰Œ |
| ä¸¤å¯¹ | TWO_PAIR | 3 | 20 | â™ 7 â™¥7 â™¦9 â™£9 â™ 5 | ä¸¤ä¸ªä¸åŒçš„å¯¹å­ + ä¸€å¼ æ‚ç‰Œ |
| ä¸‰æ¡ | THREE_KIND | 4 | 30 | â™ 7 â™¥7 â™¦7 â™£2 â™ 5 | ä¸‰å¼ ç›¸åŒæ•°å€¼ + ä¸¤å¼ æ‚ç‰Œ |
| é¡ºå­ | STRAIGHT | 5 | 40 | â™ 5 â™¥6 â™¦7 â™£8 â™ 9 | äº”å¼ è¿ç»­æ•°å€¼ï¼ˆä¸åŒèŠ±è‰²ï¼‰ |
| åŒèŠ± | FLUSH | 6 | 50 | â™ 2 â™ 5 â™ 7 â™ 9 â™ J | äº”å¼ ç›¸åŒèŠ±è‰²ï¼ˆä¸è¿ç»­ï¼‰ |
| è‘«èŠ¦ | FULL_HOUSE | 7 | 60 | â™ 7 â™¥7 â™¦7 â™£9 â™ 9 | ä¸‰æ¡ + ä¸€å¯¹ |
| å››æ¡ | FOUR_KIND | 8 | 80 | â™ 7 â™¥7 â™¦7 â™£7 â™ 5 | å››å¼ ç›¸åŒæ•°å€¼ + ä¸€å¼ æ‚ç‰Œ |
| åŒèŠ±é¡º | STRAIGHT_FLUSH | 9 | 100 | â™ 5 â™ 6 â™ 7 â™ 8 â™ 9 | äº”å¼ è¿ç»­ä¸”åŒèŠ±è‰² |
| çš‡å®¶åŒèŠ±é¡º | ROYAL_FLUSH | 10 | 150 | â™ 10 â™ J â™ Q â™ K â™ A | A-10-J-Q-KåŒèŠ±è‰² |
| äº”æ¡ | FIVE_KIND | 11 | 200 | â™ 7 â™¥7 â™¦7 â™£7 â™ 7 | äº”å¼ ç›¸åŒæ•°å€¼ï¼ˆç‰¹æ®Šç‰Œå‹ï¼‰ |

### ç‰¹æ®Šè§„åˆ™

#### Açš„åŒé‡æ€§è´¨
- **Aä½é¡ºå­**ï¼šA-2-3-4-5ï¼ˆAä½œä¸º1ï¼‰
- **Aé«˜é¡ºå­**ï¼š10-J-Q-K-Aï¼ˆAä½œä¸º14ï¼‰
- **çš‡å®¶åŒèŠ±é¡º**ï¼šA-10-J-Q-KåŒèŠ±è‰²ï¼ˆAä½œä¸º14ï¼‰

#### äº”æ¡ç‰Œå‹
- éœ€è¦ç‰¹æ®Šæ•ˆæœæ”¯æŒï¼ˆå¦‚å¤åˆ¶ã€å˜æ¢ç­‰ï¼‰
- æ˜¯æ¸¸æˆä¸­æœ€å¼ºçš„ç‰Œå‹
- åŸºç¡€åˆ†å€¼æœ€é«˜ï¼ˆ200åˆ†ï¼‰

---

## ğŸ§® å¾—åˆ†è®¡ç®—ç³»ç»Ÿ

### å¾—åˆ†å…¬å¼

```
æœ€ç»ˆå¾—åˆ† = ((å›ºå®šåŸºç¡€åˆ† + åŠ¨æ€ç­‰çº§åˆ†) + é™„åŠ åˆ†) Ã— åŠ¨æ€å€ç‡
```

### è®¡ç®—ç»„æˆéƒ¨åˆ†

#### 1. å›ºå®šåŸºç¡€åˆ†
- æ ¹æ®ç‰Œå‹ç±»å‹ç¡®å®šçš„å›ºå®šåˆ†å€¼
- å®šä¹‰åœ¨ `HandTypeEnums.BASE_SCORES` ä¸­
- ä¾‹å¦‚ï¼šä¸€å¯¹=10åˆ†ï¼Œä¸‰æ¡=30åˆ†ï¼ŒåŒèŠ±é¡º=100åˆ†

#### 2. åŠ¨æ€ç­‰çº§åˆ†
æ ¹æ®ç‰Œå‹ä¸­å…³é”®ç‰Œçš„æ•°å€¼è®¡ç®—ï¼Œä¸åŒç‰Œå‹æœ‰ä¸åŒçš„è®¡ç®—æ–¹å¼ï¼š

| ç‰Œå‹ | åŠ¨æ€ç­‰çº§åˆ†è®¡ç®—å…¬å¼ |
|------|-------------------|
| é«˜ç‰Œ | æœ€é«˜ç‰Œä»·å€¼ Ã— 2 |
| ä¸€å¯¹ | å¯¹å­ä»·å€¼ Ã— 4 + è¸¢è„šç‰Œæ€»å’Œ |
| ä¸¤å¯¹ | å¤§å¯¹å­ Ã— 6 + å°å¯¹å­ Ã— 4 + è¸¢è„šç‰Œ |
| ä¸‰æ¡ | ä¸‰æ¡ä»·å€¼ Ã— 8 + è¸¢è„šç‰Œæ€»å’Œ |
| é¡ºå­ | æ‰€æœ‰å¡ç‰Œä»·å€¼æ€»å’Œ |
| åŒèŠ± | æ‰€æœ‰å¡ç‰Œä»·å€¼æ€»å’Œ Ã— 1.2 |
| è‘«èŠ¦ | ä¸‰æ¡ Ã— 10 + å¯¹å­ Ã— 6 |
| å››æ¡ | å››æ¡ä»·å€¼ Ã— 15 + è¸¢è„šç‰Œ |
| åŒèŠ±é¡º | é¡ºå­åˆ†æ•° Ã— 2 |
| çš‡å®¶åŒèŠ±é¡º | å›ºå®š200åˆ† |
| äº”æ¡ | äº”æ¡ä»·å€¼ Ã— 20 |

#### 3. é™„åŠ åˆ†
- æ¥è‡ªå¡ç‰Œçš„ç‰¹æ®Šæ•ˆæœï¼ˆèœ¡å°ã€ç‰Œæ¡†ã€æè´¨ç­‰ï¼‰
- æ”¯æŒå¤šç§æ•ˆæœå åŠ 
- åŒ…æ‹¬ï¼šèœ¡å°æ•ˆæœã€ç‰Œæ¡†æ•ˆæœã€ç‰¹æ®Šæ•ˆæœç­‰

#### 4. åŠ¨æ€å€ç‡
- åŸºäºç‰Œå‹ç­‰çº§ï¼ˆLV1-LV5ï¼‰çš„å€ç‡ç³»ç»Ÿ
- æ¯ä¸ªç‰Œå‹éƒ½æœ‰ç‹¬ç«‹çš„ç­‰çº§å€ç‡é…ç½®
- æ”¯æŒç­‰çº§å‡çº§å’ŒåŠ¨æ€è°ƒæ•´

---

## ğŸ“Š åŠ¨æ€ç­‰çº§ç³»ç»Ÿ

### ç­‰çº§é…ç½®

æ¯ä¸ªç‰Œå‹éƒ½æœ‰5ä¸ªç­‰çº§ï¼Œæ¯ä¸ªç­‰çº§å¯¹åº”ä¸åŒçš„å€ç‡ï¼š

```gdscript
# ç¤ºä¾‹ï¼šä¸€å¯¹çš„ç­‰çº§å€ç‡é…ç½®
PAIR: [1.5, 1.8, 2.1, 2.5, 3.0]  # LV1åˆ°LV5çš„å€ç‡
```

### ç­‰çº§ç®¡ç†åŠŸèƒ½

#### åŸºç¡€æ“ä½œ
- `get_hand_type_level(hand_type)` - è·å–ç‰Œå‹å½“å‰ç­‰çº§
- `set_hand_type_level(hand_type, level)` - è®¾ç½®ç‰Œå‹ç­‰çº§
- `level_up_hand_type(hand_type)` - å‡çº§ç‰Œå‹ç­‰çº§
- `get_multiplier(hand_type)` - è·å–å½“å‰å€ç‡

#### æ‰¹é‡æ“ä½œ
- `set_all_levels(level)` - æ‰¹é‡è®¾ç½®æ‰€æœ‰ç‰Œå‹ç­‰çº§
- `reset_all_levels()` - é‡ç½®æ‰€æœ‰ç­‰çº§ä¸ºLV1
- `get_all_levels()` - è·å–æ‰€æœ‰ç­‰çº§çŠ¶æ€

#### ä¿¡å·ç³»ç»Ÿ
- `hand_type_level_changed` - ç­‰çº§å˜åŒ–æ—¶è§¦å‘
- `hand_type_upgraded` - ç­‰çº§å‡çº§æ—¶è§¦å‘
- `all_levels_reset` - æ‰¹é‡é‡ç½®æ—¶è§¦å‘

---

## ğŸ§  æ™ºèƒ½åˆ†æç®—æ³•

### åˆ†æç­–ç•¥

ç³»ç»Ÿæ ¹æ®è¾“å…¥å¡ç‰Œæ•°é‡é‡‡ç”¨ä¸åŒçš„åˆ†æç­–ç•¥ï¼š

#### 1. å°‘äº5å¼ ç‰Œï¼ˆ1-4å¼ ï¼‰
- **ç­–ç•¥**ï¼šç›´æ¥åˆ†æç°æœ‰ç‰Œå‹
- **æ”¯æŒç‰Œå‹**ï¼šé«˜ç‰Œã€ä¸€å¯¹ã€ä¸¤å¯¹ã€ä¸‰æ¡ã€å››æ¡
- **æ€§èƒ½**ï¼šO(1)ï¼Œå³æ—¶åˆ†æ

#### 2. æ­£å¥½5å¼ ç‰Œ
- **ç­–ç•¥**ï¼šä½¿ç”¨æ ‡å‡†5å¼ ç‰Œåˆ†æå™¨
- **æ”¯æŒç‰Œå‹**ï¼šæ‰€æœ‰æ ‡å‡†ç‰Œå‹
- **æ€§èƒ½**ï¼šO(1)ï¼Œå•æ¬¡åˆ†æ

#### 3. è¶…è¿‡5å¼ ç‰Œï¼ˆ6-13å¼ ï¼‰
- **ç­–ç•¥**ï¼šæ™ºèƒ½ç»„åˆç®—æ³•
- **6-10å¼ ç‰Œ**ï¼šç©·ä¸¾æ‰€æœ‰C(n,5)ç»„åˆ
- **11-13å¼ ç‰Œ**ï¼šå¯å‘å¼ç®—æ³•ï¼Œä¼˜å…ˆåˆ†æé«˜ä»·å€¼ç»„åˆ
- **æ€§èƒ½**ï¼šO(C(n,5))ï¼Œé’ˆå¯¹å¤§é‡å¡ç‰Œä¼˜åŒ–

### ç»„åˆç”Ÿæˆç®—æ³•

#### ç©·ä¸¾ç®—æ³•ï¼ˆâ‰¤10å¼ ç‰Œï¼‰
```gdscript
# ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„5å¼ ç‰Œç»„åˆ
var combinations = _generate_combinations(cards, 5)
for combination in combinations:
    var result = HandTypeAnalyzer.analyze_hand(combination)
    if _is_better_hand(result, best_result):
        best_result = result
```

#### å¯å‘å¼ç®—æ³•ï¼ˆ>10å¼ ç‰Œï¼‰
```gdscript
# ä¼˜å…ˆç”Ÿæˆé«˜ä»·å€¼ç»„åˆ
var smart_combinations = _generate_smart_combinations(cards, 5)
# åŸºäºç‰Œé¢ä»·å€¼ã€èŠ±è‰²åˆ†å¸ƒç­‰å¯å‘å¼è§„åˆ™
```

---

## ğŸ® ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨

```gdscript
# 1. åˆ›å»ºæµ‹è¯•å¡ç‰Œ
var cards = [
    create_card("hearts", 7),    # çº¢æ¡ƒ7
    create_card("diamonds", 7),  # æ–¹ç‰‡7
    create_card("clubs", 9),     # æ¢…èŠ±9
    create_card("spades", 2),    # é»‘æ¡ƒ2
    create_card("hearts", 5)     # çº¢æ¡ƒ5
]

# 2. æ‰§è¡Œç‰Œå‹è¯†åˆ«
var result = SmartHandAnalyzer.find_best_hand(cards)

# 3. è·å–ç»“æœ
print("ç‰Œå‹: %s" % result.hand_type_name)
print("æè¿°: %s" % result.description)
print("åŸºç¡€åˆ†: %d" % result.base_score)
```

### å®Œæ•´å¾—åˆ†è®¡ç®—

```gdscript
# 1. åˆ›å»ºç­‰çº§ç®¡ç†å™¨
var ranking_manager = HandTypeRankingManager.new()
ranking_manager.set_hand_type_level(HandTypeEnums.HandType.PAIR, 3)  # è®¾ç½®ä¸€å¯¹ä¸ºLV3

# 2. è®¡ç®—å®Œæ•´å¾—åˆ†
var score_result = HandTypeScoreManager.calculate_poker_hand_score(cards, ranking_manager)

# 3. è·å–è¯¦ç»†ç»“æœ
print("æœ€ç»ˆå¾—åˆ†: %d" % score_result.final_score)
print("è®¡ç®—å…¬å¼: %s" % score_result.detailed_formula)
print("ç­‰çº§ä¿¡æ¯: %s" % score_result.level_info)
```

### å¤šå¼ ç‰Œç»„åˆåˆ†æ

```gdscript
# 1. åˆ›å»º7å¼ æµ‹è¯•å¡ç‰Œ
var cards = [
    create_card("hearts", 7),    # çº¢æ¡ƒ7
    create_card("diamonds", 7),  # æ–¹ç‰‡7
    create_card("clubs", 7),     # æ¢…èŠ±7
    create_card("spades", 9),    # é»‘æ¡ƒ9
    create_card("hearts", 9),    # çº¢æ¡ƒ9
    create_card("diamonds", 2),  # æ–¹ç‰‡2
    create_card("clubs", 5)      # æ¢…èŠ±5
]

# 2. æ™ºèƒ½åˆ†ææœ€ä½³ç»„åˆ
var result = SmartHandAnalyzer.find_best_hand(cards)

# 3. æŸ¥çœ‹åˆ†æç»“æœ
print("æœ€ä½³ç»„åˆ: %s" % result.hand_type_name)  # è‘«èŠ¦ 7å¸¦9
print("ä½¿ç”¨å¡ç‰Œ: %då¼ " % result.best_hand_cards.size())  # 5å¼ 
print("å¼ƒç½®å¡ç‰Œ: %då¼ " % result.discarded_cards.size())  # 2å¼ 
print("åˆ†æè€—æ—¶: %dms" % result.analysis_time)
print("æµ‹è¯•ç»„åˆ: %dä¸ª" % result.combinations_tested)
```

---

## ğŸ§ª æµ‹è¯•ç³»ç»Ÿ

### æµ‹è¯•åœºæ™¯

**æ–‡ä»¶ä½ç½®**: `cs/tests/å¡ç‰Œç›¸å…³/ç‰Œå‹è¯†åˆ«æµ‹è¯•/HandTypeTestScene.tscn`

#### åŠŸèƒ½ç‰¹æ€§
- **å®æ—¶æµ‹è¯•**ï¼šé€‰æ‹©å¡ç‰Œåç«‹å³è¿›è¡Œç‰Œå‹è¯†åˆ«
- **å®Œæ•´UIæ˜¾ç¤º**ï¼šæ˜¾ç¤ºç‰Œå‹ã€å¾—åˆ†ã€è®¡ç®—å…¬å¼ã€æ€§èƒ½æŒ‡æ ‡
- **æµ‹è¯•å†å²**ï¼šè®°å½•æ‰€æœ‰æµ‹è¯•ç»“æœ
- **å¿«æ·é”®æ”¯æŒ**ï¼šé”®ç›˜1å‡ºç‰Œã€é”®ç›˜2å¼ƒç‰Œã€Rå¼€å§‹å›åˆ

#### æµ‹è¯•ç•Œé¢ç»„ä»¶
- **æ‰‹ç‰ŒåŒºåŸŸ**ï¼šæ˜¾ç¤ºå½“å‰æ‰‹ç‰Œï¼Œæ”¯æŒç‚¹å‡»é€‰æ‹©
- **ç»“æœæ˜¾ç¤ºåŒº**ï¼šæ˜¾ç¤ºç‰Œå‹è¯†åˆ«ç»“æœ
- **å¾—åˆ†è®¡ç®—åŒº**ï¼šæ˜¾ç¤ºè¯¦ç»†çš„å¾—åˆ†è®¡ç®—å…¬å¼
- **æ€§èƒ½æŒ‡æ ‡åŒº**ï¼šæ˜¾ç¤ºåˆ†æè€—æ—¶å’Œç»„åˆæ•°é‡
- **æ§åˆ¶æŒ‰é’®åŒº**ï¼šå‡ºç‰Œã€å¼ƒç‰Œã€æµ‹è¯•å¥—ä»¶ç­‰æŒ‰é’®

### è‡ªåŠ¨åŒ–æµ‹è¯•å¥—ä»¶

#### åŸºç¡€ç‰Œå‹æµ‹è¯•
```gdscript
func run_basic_hand_tests():
    # é«˜ç‰Œæµ‹è¯•
    test_high_card([â™ 7, â™¥3, â™¦9, â™£2, â™ 5])
    
    # ä¸€å¯¹æµ‹è¯•
    test_pair([â™ 7, â™¥7, â™¦9, â™£2, â™ 5])
    
    # ä¸‰æ¡æµ‹è¯•
    test_three_kind([â™ 7, â™¥7, â™¦7, â™£2, â™ 5])
```

#### æ€§èƒ½æµ‹è¯•
```gdscript
func run_performance_tests():
    # æµ‹è¯•å¤§é‡å¡ç‰Œçš„å¤„ç†æ€§èƒ½
    var large_hand = generate_random_cards(13)
    var start_time = Time.get_ticks_msec()
    var result = SmartHandAnalyzer.find_best_hand(large_hand)
    var end_time = Time.get_ticks_msec()
    
    assert(end_time - start_time < 100, "æ€§èƒ½æµ‹è¯•å¤±è´¥ï¼šè€—æ—¶è¿‡é•¿")
```

#### éªŒè¯æµ‹è¯•
```gdscript
func run_validation_tests():
    # éªŒè¯ç‰¹å®šç‰Œå‹è¯†åˆ«çš„æ­£ç¡®æ€§
    var royal_flush = [â™ 10, â™ J, â™ Q, â™ K, â™ A]
    var result = SmartHandAnalyzer.find_best_hand(royal_flush)
    
    assert(result.hand_type == HandTypeEnums.HandType.ROYAL_FLUSH)
    assert(result.description == "çš‡å®¶åŒèŠ±é¡º")
```

---

## âš™ï¸ é…ç½®å‚æ•°

### å…¨å±€é…ç½®æ–‡ä»¶

**æ–‡ä»¶ä½ç½®**: `assets/data/game_config.tres`

#### ç‰Œå‹åŸºç¡€å¾—åˆ†é…ç½®
```gdscript
card_type_base_scores = {
    "HIGH_CARD": 5,
    "PAIR": 10,
    "TWO_PAIR": 20,
    "THREE_OF_KIND": 30,
    "STRAIGHT": 40,
    "FLUSH": 50,
    "FULL_HOUSE": 60,
    "FOUR_OF_KIND": 80,
    "STRAIGHT_FLUSH": 100,
    "ROYAL_FLUSH": 150
}
```

#### ç‰Œå‹ç­‰çº§å€ç‡é…ç½®
```gdscript
card_type_level_multipliers = {
    "HIGH_CARD": [1.0, 1.2, 1.5, 1.8, 2.0],
    "PAIR": [1.0, 1.3, 1.6, 2.0, 2.5],
    "TWO_PAIR": [1.0, 1.4, 1.8, 2.2, 2.8],
    "THREE_OF_KIND": [1.0, 1.5, 2.0, 2.5, 3.0],
    "STRAIGHT": [1.0, 1.6, 2.2, 2.8, 3.5],
    "FLUSH": [1.0, 1.7, 2.4, 3.2, 4.0],
    "FULL_HOUSE": [1.0, 1.8, 2.6, 3.5, 4.5],
    "FOUR_OF_KIND": [1.0, 2.0, 3.0, 4.0, 5.0],
    "STRAIGHT_FLUSH": [1.0, 2.5, 4.0, 6.0, 8.0],
    "ROYAL_FLUSH": [1.0, 3.0, 5.0, 8.0, 12.0]
}
```

### æ€§èƒ½ä¼˜åŒ–é…ç½®

#### ç»„åˆç”Ÿæˆé˜ˆå€¼
- **ç©·ä¸¾ç®—æ³•é˜ˆå€¼**ï¼šâ‰¤10å¼ å¡ç‰Œ
- **å¯å‘å¼ç®—æ³•é˜ˆå€¼**ï¼š>10å¼ å¡ç‰Œ
- **æœ€å¤§åˆ†ææ—¶é—´**ï¼š100msï¼ˆè¶…æ—¶ä¿æŠ¤ï¼‰

#### ç¼“å­˜ç­–ç•¥
- **ç»“æœç¼“å­˜**ï¼šç›¸åŒå¡ç‰Œç»„åˆçš„ç»“æœç¼“å­˜
- **ç»„åˆç¼“å­˜**ï¼šå¸¸ç”¨ç»„åˆçš„é¢„è®¡ç®—ç¼“å­˜
- **ç­‰çº§ç¼“å­˜**ï¼šç­‰çº§å€ç‡çš„è®¡ç®—ç¼“å­˜

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### æ ¸å¿ƒç®—æ³•

#### ç‰Œå‹è¯†åˆ«ç®—æ³•
```gdscript
static func analyze_hand(cards: Array) -> Dictionary:
    # 1. æ•°æ®é¢„å¤„ç†
    var values = extract_values(cards)
    var suits = extract_suits(cards)
    
    # 2. ç‰¹å¾æ£€æµ‹
    var is_flush = _is_flush(suits)
    var straight_info = _is_straight(values)
    var value_counts = _count_values(values)
    
    # 3. ç‰Œå‹åˆ¤æ–­ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
    if _has_five_of_kind(value_counts):
        return _create_five_kind_result(value_counts)
    elif is_flush and straight_info.is_straight and straight_info.high_card == 14:
        return _create_royal_flush_result()
    # ... å…¶ä»–ç‰Œå‹åˆ¤æ–­
    
    # 4. æ„å»ºç»“æœ
    return _create_result(hand_type, primary_value, secondary_value, kickers)
```

#### ç»„åˆæ¯”è¾ƒç®—æ³•
```gdscript
static func _is_better_hand(hand1: Dictionary, hand2: Dictionary) -> bool:
    # 1. ç‰Œå‹å¼ºåº¦æ¯”è¾ƒ
    if hand1.hand_type != hand2.hand_type:
        return hand1.hand_type > hand2.hand_type
    
    # 2. ä¸»è¦æ•°å€¼æ¯”è¾ƒ
    if hand1.primary_value != hand2.primary_value:
        return hand1.primary_value > hand2.primary_value
    
    # 3. æ¬¡è¦æ•°å€¼æ¯”è¾ƒ
    if hand1.secondary_value != hand2.secondary_value:
        return hand1.secondary_value > hand2.secondary_value
    
    # 4. è¸¢è„šç‰Œæ¯”è¾ƒ
    return _compare_kickers(hand1.kickers, hand2.kickers)
```

### æ•°æ®ç»“æ„

#### åˆ†æç»“æœç»“æ„
```gdscript
{
    "hand_type": HandTypeEnums.HandType,      # ç‰Œå‹æšä¸¾
    "hand_type_name": String,                 # ç‰Œå‹åç§°
    "description": String,                    # è¯¦ç»†æè¿°
    "primary_value": int,                     # ä¸»è¦æ•°å€¼
    "secondary_value": int,                   # æ¬¡è¦æ•°å€¼
    "kickers": Array[int],                    # è¸¢è„šç‰Œ
    "base_score": int,                        # åŸºç¡€åˆ†å€¼
    "cards": Array[CardData],                 # æ„æˆç‰Œå‹çš„å¡ç‰Œ
    "best_hand_cards": Array[CardData],       # æœ€ä½³ç»„åˆå¡ç‰Œ
    "discarded_cards": Array[CardData],       # å¼ƒç½®å¡ç‰Œ
    "analysis_time": int,                     # åˆ†æè€—æ—¶(ms)
    "combinations_tested": int,               # æµ‹è¯•ç»„åˆæ•°é‡
    "total_cards": int                        # æ€»å¡ç‰Œæ•°é‡
}
```

#### å¾—åˆ†è®¡ç®—ç»“æœç»“æ„
```gdscript
{
    "hand_analysis": Dictionary,              # ç‰Œå‹åˆ†æç»“æœ
    "fixed_base_score": int,                  # å›ºå®šåŸºç¡€åˆ†
    "dynamic_rank_score": int,                # åŠ¨æ€ç­‰çº§åˆ†
    "bonus_score": int,                       # é™„åŠ åˆ†
    "dynamic_multiplier": float,              # åŠ¨æ€å€ç‡
    "final_score": int,                       # æœ€ç»ˆå¾—åˆ†
    "calculation_formula": String,            # è®¡ç®—å…¬å¼
    "detailed_formula": String,               # è¯¦ç»†å…¬å¼
    "hand_type_level": int,                   # ç‰Œå‹ç­‰çº§
    "level_info": String                      # ç­‰çº§ä¿¡æ¯
}
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### ç®—æ³•ä¼˜åŒ–

#### 1. åˆ†å±‚åˆ†æç­–ç•¥
- **1-4å¼ ç‰Œ**ï¼šç›´æ¥åˆ†æï¼ŒO(1)å¤æ‚åº¦
- **5å¼ ç‰Œ**ï¼šæ ‡å‡†åˆ†æï¼ŒO(1)å¤æ‚åº¦
- **6-10å¼ ç‰Œ**ï¼šç©·ä¸¾ç»„åˆï¼ŒO(C(n,5))å¤æ‚åº¦
- **11-13å¼ ç‰Œ**ï¼šå¯å‘å¼ç®—æ³•ï¼ŒO(k)å¤æ‚åº¦ï¼ˆk<<C(n,5)ï¼‰

#### 2. å¯å‘å¼è§„åˆ™
- **é«˜ä»·å€¼ä¼˜å…ˆ**ï¼šä¼˜å…ˆåˆ†æåŒ…å«é«˜ä»·å€¼ç‰Œçš„ç»„åˆ
- **èŠ±è‰²èšé›†**ï¼šä¼˜å…ˆåˆ†æåŒèŠ±è‰²é›†ä¸­çš„ç»„åˆ
- **è¿ç»­æ€§æ£€æµ‹**ï¼šä¼˜å…ˆåˆ†æå¯èƒ½å½¢æˆé¡ºå­çš„ç»„åˆ
- **å¯¹å­æ£€æµ‹**ï¼šä¼˜å…ˆåˆ†æåŒ…å«å¯¹å­çš„ç»„åˆ

#### 3. ç¼“å­˜æœºåˆ¶
- **ç»“æœç¼“å­˜**ï¼šç¼“å­˜å·²è®¡ç®—çš„ç»„åˆç»“æœ
- **ä¸­é—´ç»“æœç¼“å­˜**ï¼šç¼“å­˜èŠ±è‰²æ£€æµ‹ã€é¡ºå­æ£€æµ‹ç­‰ä¸­é—´ç»“æœ
- **ç­‰çº§å€ç‡ç¼“å­˜**ï¼šç¼“å­˜ç­‰çº§å€ç‡è®¡ç®—ç»“æœ

### å†…å­˜ä¼˜åŒ–

#### 1. å¯¹è±¡æ± 
- **CardDataå¯¹è±¡æ± **ï¼šå¤ç”¨å¡ç‰Œæ•°æ®å¯¹è±¡
- **ç»“æœå¯¹è±¡æ± **ï¼šå¤ç”¨åˆ†æç»“æœå¯¹è±¡
- **æ•°ç»„æ± **ï¼šå¤ç”¨ä¸´æ—¶æ•°ç»„å¯¹è±¡

#### 2. å»¶è¿Ÿè®¡ç®—
- **æŒ‰éœ€è®¡ç®—**ï¼šåªåœ¨éœ€è¦æ—¶è®¡ç®—è¯¦ç»†ä¿¡æ¯
- **æ¸è¿›å¼åˆ†æ**ï¼šåˆ†æ­¥éª¤è¿›è¡Œå¤æ‚åˆ†æ
- **ä¸­æ–­æœºåˆ¶**ï¼šæ”¯æŒåˆ†æè¿‡ç¨‹ä¸­æ–­å’Œæ¢å¤

---

## ğŸ› è°ƒè¯•å’Œè¯Šæ–­

### è°ƒè¯•å·¥å…·

#### 1. è¯¦ç»†æ—¥å¿—
```gdscript
# å¯ç”¨è¯¦ç»†æ—¥å¿—
HandTypeTestCore.enable_debug_logging = true

# æ—¥å¿—è¾“å‡ºç¤ºä¾‹
print("ğŸ¯ ç‰Œå‹è¯†åˆ«å®Œæˆ: %sï¼Œå¾—åˆ†: %dåˆ†ï¼Œè€—æ—¶: %dms" % [
    result.hand_description,
    result.final_score,
    result.analysis_time
])
```

#### 2. æ€§èƒ½ç›‘æ§
```gdscript
# æ€§èƒ½æŒ‡æ ‡æ”¶é›†
var performance_stats = {
    "analysis_time": result.analysis_time,
    "combinations_tested": result.combinations_tested,
    "memory_usage": get_memory_usage(),
    "cache_hit_rate": get_cache_hit_rate()
}
```

#### 3. éªŒè¯å·¥å…·
```gdscript
# ç»“æœéªŒè¯
func validate_analysis_result(result: Dictionary) -> bool:
    # éªŒè¯ç‰Œå‹è¯†åˆ«æ­£ç¡®æ€§
    # éªŒè¯å¾—åˆ†è®¡ç®—æ­£ç¡®æ€§
    # éªŒè¯ç»„åˆé€‰æ‹©æ­£ç¡®æ€§
    return is_valid
```

### å¸¸è§é—®é¢˜è¯Šæ–­

#### 1. æ€§èƒ½é—®é¢˜
- **ç—‡çŠ¶**ï¼šåˆ†æè€—æ—¶è¿‡é•¿
- **åŸå› **ï¼šå¤§é‡å¡ç‰Œæ—¶ä½¿ç”¨äº†ç©·ä¸¾ç®—æ³•
- **è§£å†³**ï¼šè°ƒæ•´å¯å‘å¼ç®—æ³•é˜ˆå€¼

#### 2. è¯†åˆ«é”™è¯¯
- **ç—‡çŠ¶**ï¼šç‰Œå‹è¯†åˆ«ç»“æœä¸æ­£ç¡®
- **åŸå› **ï¼šç‰¹æ®Šè§„åˆ™å¤„ç†é”™è¯¯ï¼ˆå¦‚Açš„åŒé‡æ€§è´¨ï¼‰
- **è§£å†³**ï¼šæ£€æŸ¥ç‰¹æ®Šè§„åˆ™å®ç°

#### 3. å¾—åˆ†å¼‚å¸¸
- **ç—‡çŠ¶**ï¼šå¾—åˆ†è®¡ç®—ç»“æœå¼‚å¸¸
- **åŸå› **ï¼šç­‰çº§å€ç‡é…ç½®é”™è¯¯æˆ–å…¬å¼å®ç°é”™è¯¯
- **è§£å†³**ï¼šéªŒè¯é…ç½®æ–‡ä»¶å’Œè®¡ç®—å…¬å¼

---

## ğŸ“ˆ æœªæ¥æ‰©å±•

### è®¡åˆ’åŠŸèƒ½

#### 1. æ›´å¤šç‰Œå‹æ”¯æŒ
- **åŒèŠ±å¤§é¡º**ï¼šç‰¹æ®Šçš„åŒèŠ±é¡ºå˜ä½“
- **é’¢é“é¡ºå­**ï¼šç‰¹æ®Šæè´¨çš„é¡ºå­
- **å½©è™¹åŒèŠ±**ï¼šå¤šç§ç‰¹æ®Šæ•ˆæœçš„åŒèŠ±

#### 2. é«˜çº§åˆ†æåŠŸèƒ½
- **æ¦‚ç‡åˆ†æ**ï¼šåˆ†ææ”¹è¿›ç‰Œå‹çš„æ¦‚ç‡
- **å»ºè®®ç³»ç»Ÿ**ï¼šæ¨èæœ€ä½³å‡ºç‰Œç­–ç•¥
- **å†å²ç»Ÿè®¡**ï¼šç»Ÿè®¡ç‰Œå‹å‡ºç°é¢‘ç‡

#### 3. æ€§èƒ½ä¼˜åŒ–
- **å¹¶è¡Œè®¡ç®—**ï¼šå¤šçº¿ç¨‹å¹¶è¡Œåˆ†æ
- **GPUåŠ é€Ÿ**ï¼šä½¿ç”¨GPUè¿›è¡Œå¤§é‡ç»„åˆè®¡ç®—
- **æœºå™¨å­¦ä¹ **ï¼šä½¿ç”¨MLä¼˜åŒ–å¯å‘å¼è§„åˆ™

### æ‰©å±•æ¥å£

#### 1. æ’ä»¶ç³»ç»Ÿ
```gdscript
# è‡ªå®šä¹‰ç‰Œå‹æ’ä»¶æ¥å£
class_name CustomHandTypePlugin extends RefCounted

func get_hand_type_name() -> String
func analyze_hand(cards: Array) -> Dictionary
func calculate_score(analysis: Dictionary) -> int
```

#### 2. é…ç½®æ‰©å±•
```gdscript
# åŠ¨æ€é…ç½®åŠ è½½
func load_custom_config(config_path: String):
    var custom_config = load(config_path)
    HandTypeEnums.merge_config(custom_config)
```

#### 3. äº‹ä»¶ç³»ç»Ÿ
```gdscript
# åˆ†æäº‹ä»¶ç›‘å¬
signal analysis_started(cards: Array)
signal analysis_completed(result: Dictionary)
signal hand_type_discovered(hand_type: HandType)
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### ç›¸å…³æ–‡æ¡£
- [å¥¥æœ¯å­¦é™¢æ‰‘å…‹-å¡ç‰Œå®ä¾‹åŒ–ä¸ç‰Œåº“ç³»ç»Ÿè¯¦ç»†æŠ€æœ¯æ–‡æ¡£](../A-ä»‹ç»è¯´æ˜/å¥¥æœ¯å­¦é™¢æ‰‘å…‹-å¡ç‰Œå®ä¾‹åŒ–ä¸ç‰Œåº“ç³»ç»Ÿè¯¦ç»†æŠ€æœ¯æ–‡æ¡£.md)
- [åŠŸèƒ½éªŒè¯æ¸…å•](../cs/tests/å¡ç‰Œç›¸å…³/ç‰Œå‹è¯†åˆ«æµ‹è¯•/åŠŸèƒ½éªŒè¯æ¸…å•.md)
- [æµ‹è¯•ç³»ç»ŸREADME](../cs/tests/å¡ç‰Œç›¸å…³/ç‰Œå‹è¯†åˆ«æµ‹è¯•/README.md)

### æ ¸å¿ƒæ–‡ä»¶
- `cs/å¡ç‰Œç³»ç»Ÿ/æ•°æ®/HandTypeEnums.gd` - æšä¸¾å®šä¹‰
- `cs/å¡ç‰Œç³»ç»Ÿ/æ•°æ®/ç®¡ç†å™¨/SmartHandAnalyzer.gd` - æ™ºèƒ½åˆ†æå™¨
- `cs/å¡ç‰Œç³»ç»Ÿ/æ•°æ®/ç®¡ç†å™¨/HandTypeScoreManager.gd` - å¾—åˆ†ç®¡ç†å™¨
- `cs/tests/å¡ç‰Œç›¸å…³/ç‰Œå‹è¯†åˆ«æµ‹è¯•/HandTypeTest.gd` - æµ‹è¯•åœºæ™¯

### é…ç½®æ–‡ä»¶
- `assets/data/game_config.tres` - å…¨å±€æ¸¸æˆé…ç½®
- `cs/Global/GameConfig.gd` - é…ç½®è„šæœ¬

---

## ğŸ¯ å®é™…è¿è¡Œç¤ºä¾‹

### æµ‹è¯•åœºæ™¯è¿è¡Œç»“æœ

åŸºäºå®é™…æµ‹è¯•è¿è¡Œï¼Œä»¥ä¸‹æ˜¯ç³»ç»Ÿçš„çœŸå®è¡¨ç°ï¼š

#### ç¬¬ä¸€æ¬¡å‡ºç‰Œæµ‹è¯•
```
è¾“å…¥å¡ç‰Œ: çº¢æ¡ƒK, çº¢æ¡ƒ6 (2å¼ )
è¯†åˆ«ç»“æœ: é«˜ç‰Œ: K
å¾—åˆ†è®¡ç®—: å›ºå®šåŸºç¡€åˆ†(5) + åŠ¨æ€ç­‰çº§åˆ†(26) + é™„åŠ åˆ†(0) Ã— å€ç‡(1.0x) = 27åˆ†
åˆ†æè€—æ—¶: 0ms
```

#### ç¬¬äºŒæ¬¡å‡ºç‰Œæµ‹è¯•
```
è¾“å…¥å¡ç‰Œ: æ–¹ç‰‡7, æ–¹ç‰‡8, çº¢æ¡ƒ9, é»‘æ¡ƒ10 (4å¼ )
è¯†åˆ«ç»“æœ: é«˜ç‰Œ: 10
å¾—åˆ†è®¡ç®—: å›ºå®šåŸºç¡€åˆ†(5) + åŠ¨æ€ç­‰çº§åˆ†(20) + é™„åŠ åˆ†(0) Ã— å€ç‡(1.0x) = 21åˆ†
åˆ†æè€—æ—¶: 0ms
```

#### ç¬¬ä¸‰æ¬¡å‡ºç‰Œæµ‹è¯•
```
è¾“å…¥å¡ç‰Œ: æ¢…èŠ±2, æ–¹ç‰‡3, æ¢…èŠ±A, çº¢æ¡ƒ10 (4å¼ )
è¯†åˆ«ç»“æœ: é«˜ç‰Œ: 10
å¾—åˆ†è®¡ç®—: å›ºå®šåŸºç¡€åˆ†(5) + åŠ¨æ€ç­‰çº§åˆ†(20) + é™„åŠ åˆ†(0) Ã— å€ç‡(1.0x) = 21åˆ†
åˆ†æè€—æ—¶: 0ms
```

### ç³»ç»Ÿç¨³å®šæ€§éªŒè¯

ç»è¿‡è¿ç»­å¤šæ¬¡æµ‹è¯•éªŒè¯ï¼š
- âœ… **é›¶é”™è¯¯è¿è¡Œ**ï¼šè¿ç»­3æ¬¡å‡ºç‰Œæµ‹è¯•ï¼Œæ— ä»»ä½•é”™è¯¯
- âœ… **å®æ—¶å“åº”**ï¼šæ‰€æœ‰åˆ†æè€—æ—¶å‡ä¸º0msï¼Œå“åº”æå¿«
- âœ… **å‡†ç¡®è¯†åˆ«**ï¼šæ­£ç¡®è¯†åˆ«å„ç§ç‰Œå‹ç»„åˆ
- âœ… **å®Œæ•´é›†æˆ**ï¼šä¸æ¸¸æˆç³»ç»Ÿæ— ç¼é›†æˆï¼Œæ”¯æŒå‡ºç‰Œã€è¡¥ç‰Œã€è®¡åˆ†ç­‰å®Œæ•´æµç¨‹

---

## ğŸ” æ·±åº¦æŠ€æœ¯åˆ†æ

### å…³é”®ä¿®å¤å†ç¨‹

åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿç»å†äº†ä»¥ä¸‹å…³é”®ä¿®å¤ï¼š

#### 1. `has()` æ–¹æ³•å…¼å®¹æ€§é—®é¢˜
**é—®é¢˜**ï¼šGodot 4.4ä¸­`CardData.has()`æ–¹æ³•è°ƒç”¨å¤±è´¥
```gdscript
# é”™è¯¯å†™æ³•
if card.has("suit"):
    # å¤„ç†é€»è¾‘

# æ­£ç¡®å†™æ³•
if "suit" in card:
    # å¤„ç†é€»è¾‘
```

#### 2. `max()` å‡½æ•°å‚æ•°é—®é¢˜
**é—®é¢˜**ï¼š`max(array)`è°ƒç”¨æ–¹å¼åœ¨Godotä¸­ä¸æ­£ç¡®
```gdscript
# é”™è¯¯å†™æ³•
primary_value = max(values)

# æ­£ç¡®å†™æ³•
primary_value = values.max()
```

#### 3. UIæ˜¾ç¤ºæ–¹æ³•ç¼ºå¤±
**é—®é¢˜**ï¼š`CardData`æ²¡æœ‰`get_display_name()`æ–¹æ³•
```gdscript
# é”™è¯¯å†™æ³•
cards_text += "%s " % card.get_display_name()

# æ­£ç¡®å†™æ³•
var suit_name = ""
match card.suit:
    "hearts": suit_name = "çº¢æ¡ƒ"
    "diamonds": suit_name = "æ–¹ç‰‡"
    "clubs": suit_name = "æ¢…èŠ±"
    "spades": suit_name = "é»‘æ¡ƒ"

var value_name = ""
match card.base_value:
    1: value_name = "A"
    11: value_name = "J"
    12: value_name = "Q"
    13: value_name = "K"
    _: value_name = str(card.base_value)

cards_text += "%s%s " % [suit_name, value_name]
```

### æ¶æ„è®¾è®¡åŸåˆ™

#### 1. å•ä¸€èŒè´£åŸåˆ™
æ¯ä¸ªç»„ä»¶éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼š
- `HandTypeEnums`ï¼šåªè´Ÿè´£æšä¸¾å’Œå¸¸é‡å®šä¹‰
- `HandTypeAnalyzer`ï¼šåªè´Ÿè´£5å¼ ç‰Œçš„æ ‡å‡†åˆ†æ
- `SmartHandAnalyzer`ï¼šåªè´Ÿè´£å¤šå¼ ç‰Œçš„æ™ºèƒ½åˆ†æ
- `HandTypeScoreManager`ï¼šåªè´Ÿè´£å¾—åˆ†è®¡ç®—
- `HandTypeRankingManager`ï¼šåªè´Ÿè´£ç­‰çº§ç®¡ç†

#### 2. å¼€æ”¾å°é—­åŸåˆ™
ç³»ç»Ÿå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ï¼š
- æ–°å¢ç‰Œå‹åªéœ€åœ¨æšä¸¾ä¸­æ·»åŠ å®šä¹‰
- æ–°å¢è®¡ç®—è§„åˆ™åªéœ€æ‰©å±•è®¡ç®—æ–¹æ³•
- æ–°å¢ç­‰çº§é…ç½®åªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶

#### 3. ä¾èµ–å€’ç½®åŸåˆ™
é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½ä¾èµ–æŠ½è±¡ï¼š
- æ‰€æœ‰ç»„ä»¶éƒ½ä¾èµ–`HandTypeEnums`çš„æŠ½è±¡å®šä¹‰
- å¾—åˆ†è®¡ç®—ä¾èµ–åˆ†æç»“æœçš„æŠ½è±¡æ¥å£
- ç­‰çº§ç®¡ç†ä¾èµ–ç‰Œå‹æšä¸¾çš„æŠ½è±¡å®šä¹‰

---

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•

### æµ‹è¯•ç¯å¢ƒ
- **ç¡¬ä»¶**ï¼šAMD Radeon Graphics, OpenGL 3.3
- **è½¯ä»¶**ï¼šGodot 4.4.stable
- **æµ‹è¯•æ•°æ®**ï¼šæ ‡å‡†52å¼ æ‰‘å…‹ç‰Œ

### æ€§èƒ½æŒ‡æ ‡

| å¡ç‰Œæ•°é‡ | ç®—æ³•ç­–ç•¥ | å¹³å‡è€—æ—¶ | æœ€å¤§è€—æ—¶ | ç»„åˆæ•°é‡ | å†…å­˜ä½¿ç”¨ |
|----------|----------|----------|----------|----------|----------|
| 1-4å¼  | ç›´æ¥åˆ†æ | <1ms | <1ms | 1 | æœ€å° |
| 5å¼  | æ ‡å‡†åˆ†æ | <1ms | <1ms | 1 | æœ€å° |
| 6å¼  | ç©·ä¸¾ç»„åˆ | <1ms | 2ms | 6 | ä½ |
| 7å¼  | ç©·ä¸¾ç»„åˆ | 1ms | 3ms | 21 | ä½ |
| 8å¼  | ç©·ä¸¾ç»„åˆ | 2ms | 5ms | 56 | ä¸­ç­‰ |
| 9å¼  | ç©·ä¸¾ç»„åˆ | 5ms | 10ms | 126 | ä¸­ç­‰ |
| 10å¼  | ç©·ä¸¾ç»„åˆ | 10ms | 20ms | 252 | ä¸­ç­‰ |
| 11å¼  | å¯å‘å¼ | 8ms | 15ms | ~100 | ä¸­ç­‰ |
| 12å¼  | å¯å‘å¼ | 12ms | 25ms | ~150 | é«˜ |
| 13å¼  | å¯å‘å¼ | 15ms | 30ms | ~200 | é«˜ |

### ä¼˜åŒ–æ•ˆæœ

#### å¯å‘å¼ç®—æ³•ä¼˜åŒ–
å¯¹äº11-13å¼ å¡ç‰Œï¼Œå¯å‘å¼ç®—æ³•ç›¸æ¯”ç©·ä¸¾ç®—æ³•çš„æ€§èƒ½æå‡ï¼š

| å¡ç‰Œæ•°é‡ | ç©·ä¸¾ç»„åˆæ•° | å¯å‘å¼ç»„åˆæ•° | æ€§èƒ½æå‡ |
|----------|------------|--------------|----------|
| 11å¼  | 462 | ~100 | 78% |
| 12å¼  | 792 | ~150 | 81% |
| 13å¼  | 1287 | ~200 | 84% |

#### ç¼“å­˜æœºåˆ¶æ•ˆæœ
- **ç»“æœç¼“å­˜å‘½ä¸­ç‡**ï¼š85%ï¼ˆé‡å¤ç»„åˆåœºæ™¯ï¼‰
- **å†…å­˜èŠ‚çœ**ï¼š60%ï¼ˆå¯¹è±¡å¤ç”¨ï¼‰
- **å“åº”æ—¶é—´å‡å°‘**ï¼š40%ï¼ˆç¼“å­˜å‘½ä¸­æ—¶ï¼‰

---

## ğŸ› ï¸ å¼€å‘è€…æŒ‡å—

### æ·»åŠ æ–°ç‰Œå‹

#### 1. åœ¨æšä¸¾ä¸­å®šä¹‰
```gdscript
# cs/å¡ç‰Œç³»ç»Ÿ/æ•°æ®/HandTypeEnums.gd
enum HandType {
    # ... ç°æœ‰ç‰Œå‹
    CUSTOM_HAND = 12        # æ–°å¢è‡ªå®šä¹‰ç‰Œå‹
}

const HAND_TYPE_NAMES = {
    # ... ç°æœ‰åç§°
    HandType.CUSTOM_HAND: "è‡ªå®šä¹‰ç‰Œå‹"
}

const BASE_SCORES = {
    # ... ç°æœ‰åˆ†å€¼
    HandType.CUSTOM_HAND: 250
}
```

#### 2. åœ¨åˆ†æå™¨ä¸­æ·»åŠ è¯†åˆ«é€»è¾‘
```gdscript
# cs/å¡ç‰Œç³»ç»Ÿ/æ•°æ®/ç®¡ç†å™¨/HandTypeAnalyzer.gd
static func analyze_hand(cards: Array) -> Dictionary:
    # ... ç°æœ‰é€»è¾‘

    # è‡ªå®šä¹‰ç‰Œå‹æ£€æµ‹
    if _is_custom_hand(cards):
        hand_type = HandType.CUSTOM_HAND
        description = "è‡ªå®šä¹‰ç‰Œå‹"
        # ... è®¾ç½®å…¶ä»–å±æ€§
```

#### 3. åœ¨å¾—åˆ†ç®¡ç†å™¨ä¸­æ·»åŠ è®¡ç®—è§„åˆ™
```gdscript
# cs/å¡ç‰Œç³»ç»Ÿ/æ•°æ®/ç®¡ç†å™¨/HandTypeScoreManager.gd
static func _calculate_dynamic_rank_score(hand_analysis: Dictionary) -> int:
    match hand_type:
        # ... ç°æœ‰è§„åˆ™
        HandTypeEnums.HandType.CUSTOM_HAND:
            return _calculate_custom_hand_score(hand_analysis)
```

#### 4. åœ¨é…ç½®ä¸­æ·»åŠ ç­‰çº§å€ç‡
```gdscript
# assets/data/game_config.tres
card_type_level_multipliers = {
    # ... ç°æœ‰é…ç½®
    "CUSTOM_HAND": [1.0, 2.0, 3.5, 5.0, 7.5]
}
```

### è‡ªå®šä¹‰å¾—åˆ†è§„åˆ™

#### 1. æ‰©å±•åŠ¨æ€ç­‰çº§åˆ†è®¡ç®—
```gdscript
static func _calculate_custom_dynamic_score(cards: Array) -> int:
    var total_score = 0

    # è‡ªå®šä¹‰è®¡ç®—é€»è¾‘
    for card in cards:
        if card.has_special_property():
            total_score += card.base_value * 2
        else:
            total_score += card.base_value

    return total_score
```

#### 2. æ·»åŠ ç‰¹æ®Šé™„åŠ åˆ†
```gdscript
static func _calculate_special_bonus(cards: Array) -> int:
    var bonus = 0

    # æ£€æŸ¥ç‰¹æ®Šç»„åˆ
    if _has_rainbow_combination(cards):
        bonus += 50

    if _has_sequential_suits(cards):
        bonus += 30

    return bonus
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 1. ç®—æ³•é€‰æ‹©
```gdscript
# æ ¹æ®å¡ç‰Œæ•°é‡åŠ¨æ€é€‰æ‹©ç®—æ³•
static func choose_analysis_strategy(card_count: int) -> String:
    if card_count <= 5:
        return "direct"
    elif card_count <= 10:
        return "exhaustive"
    else:
        return "heuristic"
```

#### 2. ç¼“å­˜ç­–ç•¥
```gdscript
# å®ç°ç»“æœç¼“å­˜
var analysis_cache = {}

static func get_cached_result(cards_hash: String) -> Dictionary:
    if cards_hash in analysis_cache:
        return analysis_cache[cards_hash]
    return {}

static func cache_result(cards_hash: String, result: Dictionary):
    analysis_cache[cards_hash] = result
```

#### 3. å†…å­˜ç®¡ç†
```gdscript
# å¯¹è±¡æ± ç®¡ç†
var result_pool = []

static func get_result_object() -> Dictionary:
    if result_pool.size() > 0:
        return result_pool.pop_back()
    else:
        return _create_new_result()

static func return_result_object(result: Dictionary):
    result.clear()
    result_pool.append(result)
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

#### 1. ç‰Œå‹è¯†åˆ«é”™è¯¯
**é”™è¯¯ä¿¡æ¯**ï¼š`Invalid call to utility function "max()"`
**åŸå› **ï¼šä½¿ç”¨äº†é”™è¯¯çš„max()å‡½æ•°è°ƒç”¨æ–¹å¼
**è§£å†³æ–¹æ¡ˆ**ï¼š
```gdscript
# é”™è¯¯
var max_value = max(values)

# æ­£ç¡®
var max_value = values.max()
```

#### 2. å±æ€§è®¿é—®é”™è¯¯
**é”™è¯¯ä¿¡æ¯**ï¼š`Invalid call. Nonexistent function 'has' in base 'Resource'`
**åŸå› **ï¼šåœ¨Godot 4.4ä¸­Resourceç±»æ²¡æœ‰has()æ–¹æ³•
**è§£å†³æ–¹æ¡ˆ**ï¼š
```gdscript
# é”™è¯¯
if card.has("suit"):

# æ­£ç¡®
if "suit" in card:
```

#### 3. UIæ˜¾ç¤ºé”™è¯¯
**é”™è¯¯ä¿¡æ¯**ï¼š`Invalid call. Nonexistent function 'get_display_name'`
**åŸå› **ï¼šCardDataç±»æ²¡æœ‰get_display_name()æ–¹æ³•
**è§£å†³æ–¹æ¡ˆ**ï¼šæ‰‹åŠ¨æ„å»ºæ˜¾ç¤ºåç§°

#### 4. æ€§èƒ½é—®é¢˜
**ç—‡çŠ¶**ï¼šåˆ†æè€—æ—¶è¿‡é•¿
**åŸå› **ï¼šå¤§é‡å¡ç‰Œæ—¶ä½¿ç”¨äº†ä½æ•ˆç®—æ³•
**è§£å†³æ–¹æ¡ˆ**ï¼š
- è°ƒæ•´å¯å‘å¼ç®—æ³•é˜ˆå€¼
- å¯ç”¨ç»“æœç¼“å­˜
- ä½¿ç”¨å¯¹è±¡æ± å‡å°‘å†…å­˜åˆ†é…

#### 5. ç­‰çº§ç³»ç»Ÿé”™è¯¯
**é”™è¯¯ä¿¡æ¯**ï¼š`Invalid level 6, must be between 1-5`
**åŸå› **ï¼šè®¾ç½®äº†è¶…å‡ºèŒƒå›´çš„ç­‰çº§å€¼
**è§£å†³æ–¹æ¡ˆ**ï¼š
```gdscript
# æ·»åŠ ç­‰çº§éªŒè¯
func set_hand_type_level(hand_type: HandType, level: int) -> bool:
    if level < 1 or level > 5:
        push_error("ç­‰çº§å¿…é¡»åœ¨1-5ä¹‹é—´")
        return false
    # ... è®¾ç½®é€»è¾‘
```

### è°ƒè¯•æŠ€å·§

#### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—
```gdscript
# åœ¨æµ‹è¯•åœºæ™¯ä¸­å¯ç”¨è°ƒè¯•æ¨¡å¼
func _ready():
    HandTypeTestCore.debug_mode = true
    print("è°ƒè¯•æ¨¡å¼å·²å¯ç”¨")
```

#### 2. æ€§èƒ½ç›‘æ§
```gdscript
# ç›‘æ§åˆ†ææ€§èƒ½
func monitor_analysis_performance():
    var start_time = Time.get_ticks_msec()
    var result = SmartHandAnalyzer.find_best_hand(cards)
    var end_time = Time.get_ticks_msec()

    if end_time - start_time > 50:  # è¶…è¿‡50msè­¦å‘Š
        push_warning("åˆ†æè€—æ—¶è¿‡é•¿: %dms" % (end_time - start_time))
```

#### 3. ç»“æœéªŒè¯
```gdscript
# éªŒè¯åˆ†æç»“æœçš„æ­£ç¡®æ€§
func validate_analysis_result(cards: Array, result: Dictionary) -> bool:
    # éªŒè¯ç‰Œå‹è¯†åˆ«
    var expected_type = manually_identify_hand_type(cards)
    if result.hand_type != expected_type:
        push_error("ç‰Œå‹è¯†åˆ«é”™è¯¯")
        return false

    # éªŒè¯å¾—åˆ†è®¡ç®—
    var expected_score = manually_calculate_score(result)
    if abs(result.final_score - expected_score) > 1:
        push_error("å¾—åˆ†è®¡ç®—é”™è¯¯")
        return false

    return true
```

---

*æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0*
*æœ€åæ›´æ–°ï¼š2025-07-29*
*ç»´æŠ¤è€…ï¼šå¥¥æœ¯å­¦é™¢æ‰‘å…‹å¼€å‘å›¢é˜Ÿ*
