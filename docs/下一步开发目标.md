# 下一步开发目标：对齐 v1.6 指南并完成阶段一

经过对项目现状和《奥术学院扑克——分阶段实现指南 (v1.6)》的分析，我们发现当前代码是一个较早期的版本，其核心架构（如 `GameManager`）和数据结构（如 `CardData`）与 v1.6 指南的设计不符。

因此，当前最首要的任务是**进行代码重构，使其与 v1.6 指南的基础架构对齐，并完成阶段一的核心目标**。

这不仅是添加新功能，更是建立一个稳固、可扩展的开发基础。

## 核心任务清单

### 1. 全局管理系统重构 (对齐 v1.6 - 阶段二基础)

-   **目标**：将 `GameManager` 的职责收缩，使其只专注于游戏流程和玩家状态管理。
-   **任务**:
    1.  **创建 `cs/Global/GlobalEnums.gd`**:
        -   定义 GDD 中所有的枚举（Rarity, TermType, CardReinforcementType 等）。
        -   在 Godot 项目设置中将其添加为**自动加载 (Autoload)**，命名为 `GlobalEnums`。
    2.  **创建 `cs/Global/GameConfig.gd`**:
        -   使其继承 `Resource`。
        -   添加 GDD 中定义的所有游戏配置常量（如 `victory_scores`, `term_rewards`）为 `@export` 变量。
        -   在 `assets/data/` 目录下创建其实例 `game_config.tres` 并填入初始值。
    3.  **重构 `cs/全局/GameManager.gd`**:
        -   移除所有牌库管理、手牌管理、抽牌、弃牌、计分逻辑（这些将移至 `CardManager` 和 `ScoreCalculator`）。
        -   更新其字段，使用 v1.6 指南中的术语，如 `current_year`, `current_term`, `lore_points` 等，替换旧的 `focus_count`, `essence_count`。
        -   实现指南中定义的核心流程方法 (`start_new_year`, `start_term` 等) 和信号。

### 2. 核心数据结构重构 (完成 v1.6 - 阶段一核心)

-   **目标**：建立符合 v1.6 指南的、基于 `Resource` 的数据结构。
-   **任务**:
    1.  **重构 `cs/卡牌系统/数据/CardData.gd`**:
        -   确保其继承 `Resource`。
        -   移除旧的 `modifiers` 数组。
        -   添加新的具体强化字段：`wax_seals: Array[String]`, `frame_type: String`, `material_type: String`。
        -   实现指南中定义的 `add_reinforcement()` 和 `clone()` 方法。
    2.  **创建新的数据资源脚本**:
        -   在 `cs/主场景/abilities/` (或类似目录) 下创建 `ArtifactData.gd`, `SpellData.gd`, `JokerData.gd`。
        -   根据 GDD 定义它们的字段，全部继承 `Resource`。
    3.  **创建数据资源实例 (`.tres` 文件)**:
        -   在 `assets/data/cards/` 目录下，为52张扑克牌创建对应的 `CardData.tres` 资源文件。
        -   在 `assets/data/artifacts/`, `spells/`, `jokers/` 目录下，为设计好的能力创建示例 `.tres` 文件。

### 3. 卡牌视觉强化 (完成 v1.6 - 阶段一收尾)

-   **目标**：让卡牌的视觉表现能反映其数据。
-   **任务**:
    1.  **修改 `CardView.tscn` 场景**:
        -   添加用于显示牌框、蜡封、材质的子节点。
    2.  **修改 `CardView.gd` 脚本**:
        -   实现 `_update_reinforcement_visuals()` 方法，该方法读取传入的 `CardData`，并根据其强化字段 (`frame_type`, `wax_seals` 等) 更新对应的视觉节点。

完成以上任务后，项目将拥有一个与 v1.6 设计蓝图一致的、数据驱动的坚实基础，为后续开发阶段二（核心游戏循环）和阶段三（高级卡牌操作）铺平道路。
